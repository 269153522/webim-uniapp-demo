{"version":3,"sources":["webpack:////Users/lr/Documents/work/easemob-uniapp/webim-uniapp-demo/main.js","webpack:////Users/lr/Documents/work/easemob-uniapp/webim-uniapp-demo/App.vue?1339","webpack:////Users/lr/Documents/work/easemob-uniapp/webim-uniapp-demo/App.vue","webpack:////Users/lr/Documents/work/easemob-uniapp/webim-uniapp-demo/App.vue?0b10","webpack:////Users/lr/Documents/work/easemob-uniapp/webim-uniapp-demo/App.vue?3622","webpack:////Users/lr/Documents/work/easemob-uniapp/webim-uniapp-demo/App.vue?305c"],"names":["Vue","config","productionTip","mixin","methods","setData","obj","callback","that","keys","val","data","Object","forEach","key","split","$data","key2","index","length","$set","App","mpType","app","$mount","WebIM","require","msgStorage","msgType","disp","logout","ack","receiveMsg","bodyId","id","ackMsg","message","conn","getUniqueId","set","to","from","send","body","onMessageError","err","type","uni","showToast","title","errorText","getCurrentRoute","pages","getCurrentPages","currentPage","route","calcUnReadSpot","myName","wx","getStorageSync","members","listGroups","allMembers","concat","count","reduce","result","curMember","idx","chatMsgs","groupid","roomId","toLowerCase","name","getApp","globalData","unReadMessageNum","fire","userInfo","saveFriendList","saveGroupInvitedList","isIPX","closed","curOpenOpt","open","opt","showLoading","mask","reopen","onLoginSuccess","hideLoading","redirectTo","url","getUserInfo","cb","me","login","success","res","checkIsIPhoneX","getSystemInfo","model","search","onLaunch","setInnerAudioOption","obeyMuteSwitch","logs","unshift","Date","now","setStorageSync","on","listen","onOpened","onReconnect","duration","onSocketConnected","onClosed","icon","close","onInviteMessage","push","onReadMessage","onPresence","status","i","onRoster","onVideoMessage","console","log","saveReceiveMsg","VIDEO","onAudioMessage","AUDIO","onCmdMessage","CMD","onTextMessage","TEXT","onEmojiMessage","EMOJI","onPictureMessage","IMAGE","onFileMessage","FILE","onError","error","statusCode","WEBIM_CONNCTION_DISCONNECTED","WEBIM_CONNCTION_SERVER_ERROR","WEBIM_CONNCTION_OPEN_ERROR","WEBIM_CONNCTION_AUTH_ERROR"],"mappings":"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","file":"common/main.js","sourcesContent":["import 'uni-pages';import '@dcloudio/uni-stat';import Vue from 'vue';\nimport App from './App';\n\nVue.config.productionTip = false;\n\n\nVue.mixin({\n\tmethods: {\n\t\tsetData: function(obj, callback) {\n\t\t\tlet that = this;\n\t\t\tlet keys = [];\n\t\t\tlet val, data;\n\t\t\tObject.keys(obj).forEach(function(key) {\n\t\t\t\tkeys = key.split('.');\n\t\t\t\tval = obj[key];\n\t\t\t\tdata = that.$data;\n\t\t\t\tkeys.forEach(function(key2, index) {\n\t\t\t\t\tif (index + 1 == keys.length) {\n\t\t\t\t\t\tthat.$set(data, key2, val);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (!data[key2]) {\n\t\t\t\t\t\t\tthat.$set(data, key2, {});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tdata = data[key2];\n\t\t\t\t})\n\t\t\t});\n\t\t\tcallback && callback();\n\t\t} \n\t}\n});\n\nApp.mpType = 'app';\n\nconst app = new Vue({\n    ...App\n});\napp.$mount();","import mod from \"-!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./App.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./App.vue?vue&type=script&lang=js&\"","\n// require(\"sdk/libs/strophe\");\nlet WebIM = require(\"./utils/WebIM\")[\"default\"];\nlet msgStorage = require(\"./comps/chat/msgstorage\");\nlet msgType = require(\"./comps/chat/msgtype\");\nlet disp = require(\"./utils/broadcast\");\nlet logout = false;\nfunction ack(receiveMsg) {\n  // 处理未读消息回执\n  var bodyId = receiveMsg.id; // 需要发送已读回执的消息id\n\n  var ackMsg = new WebIM.message(\"read\", WebIM.conn.getUniqueId());\n  ackMsg.set({\n    id: bodyId,\n    to: receiveMsg.from\n  });\n  WebIM.conn.send(ackMsg.body);\n}\nfunction onMessageError(err) {\n  if (err.type === \"error\") {\n    uni.showToast({\n      title: err.errorText\n    });\n    return false;\n  }\n\n  return true;\n}\nfunction getCurrentRoute() {\n  let pages = getCurrentPages();\n  let currentPage = pages[pages.length - 1];\n  return currentPage.route;\n}\nfunction calcUnReadSpot(message) {\n  let myName = wx.getStorageSync(\"myUsername\");\n  let members = wx.getStorageSync(\"member\") || []; //好友\n\n  var listGroups = wx.getStorageSync('listGroup') || []; //群组\n\n  let allMembers = members.concat(listGroups);\n  let count = allMembers.reduce(function (result, curMember, idx) {\n    let chatMsgs;\n\n    if (curMember.groupid) {\n      chatMsgs = wx.getStorageSync(curMember.roomId + myName.toLowerCase()) || [];\n    } else {\n      chatMsgs = wx.getStorageSync(curMember.name&& (curMember.name.toLowerCase() + myName.toLowerCase())) || [];\n    }\n\n    return result + chatMsgs.length;\n  }, 0);\n  getApp().globalData.unReadMessageNum = count;\n  disp.fire(\"em.unreadspot\", message);\n}\n\nexport default {\n  globalData: {\n    unReadMessageNum: 0,\n    userInfo: null,\n    saveFriendList: [],\n    saveGroupInvitedList: [],\n    isIPX: false //是否为iphone X\n    ,\n    conn: {\n      closed: false,\n      curOpenOpt: {},\n\n      open(opt) {\n        wx.showLoading({\n          title: '正在初始化客户端...',\n          mask: true\n        });\n        this.curOpenOpt = opt;\n        WebIM.conn.open(opt);\n        this.closed = false;\n      },\n\n      reopen() {\n        if (this.closed) {\n          //this.open(this.curOpenOpt);\n          WebIM.conn.open(this.curOpenOpt);\n          this.closed = false;\n        }\n      }\n\n    },\n    // onShow(){\n    // \tWebIM.conn.reconnect();\n    // },\n    // onHide(){\n    // \tWebIM.conn.close();\n    // \tWebIM.conn.stopHeartBeat();\n    // },\n    // onUnload(){\n    // \tWebIM.conn.close();\n    // \tWebIM.conn.stopHeartBeat();\n    // \twx.redirectTo({\n    // \t\turl: \"../login/login?myName=\" + myName\n    // \t});\n    // },\n    onLoginSuccess: function (myName) {\n      wx.hideLoading();\n      wx.redirectTo({\n        url: \"../chat/chat?myName=\" + myName\n      });\n    },\n\n    getUserInfo(cb) {\n      var me = this;\n\n      if (this.userInfo) {\n        typeof cb == \"function\" && cb(this.userInfo);\n      } else {\n        // 调用登录接口\n        wx.login({\n          success() {\n            wx.getUserInfo({\n              success(res) {\n                me.userInfo = res.userInfo;\n                typeof cb == \"function\" && cb(me.userInfo);\n              }\n\n            });\n          }\n\n        });\n      }\n    },\n\n    checkIsIPhoneX: function () {\n      const me = this;\n      wx.getSystemInfo({\n        success: function (res) {\n          // 根据 model 进行判断\n          if (res.model.search('iPhone X') != -1) {\n            me.isIPX = true;\n          }\n        }\n      });\n    }\n  },\n\n  // getPage(pageName){\n  // \tvar pages = getCurrentPages();\n  // \treturn pages.find(function(page){\n  // \t\treturn page.__route__ == pageName;\n  // \t});\n  // },\n  onLaunch() {\n    // 调用 API 从本地缓存中获取数据\n    wx.setInnerAudioOption({\n      obeyMuteSwitch: false\n    });\n    var me = this;\n    var logs = wx.getStorageSync(\"logs\") || [];\n    logs.unshift(Date.now());\n    wx.setStorageSync(\"logs\", logs); // \n\n    disp.on(\"em.main.ready\", function () {\n      calcUnReadSpot();\n    });\n    disp.on(\"em.chatroom.leave\", function () {\n      calcUnReadSpot();\n    });\n    disp.on(\"em.chat.session.remove\", function () {\n      calcUnReadSpot();\n    });\n    disp.on('em.chat.audio.fileLoaded', function () {\n      calcUnReadSpot();\n    });\n    disp.on('em.main.deleteFriend', function () {\n      calcUnReadSpot();\n    });\n    disp.on('em.chat.audio.fileLoaded', function () {\n      calcUnReadSpot();\n    }); // \n\n    WebIM.conn.listen({\n      onOpened(message) {\n        if (getCurrentRoute() == \"pages/login/login\" || getCurrentRoute() == \"pages/login_token/login_token\") {\n          me.globalData.onLoginSuccess(wx.getStorageSync(\"myUsername\").toLowerCase());\n        }\n      },\n\n      onReconnect() {\n        uni.showToast({\n          title: \"重连中...\",\n          duration: 2000\n        });\n      },\n\n      onSocketConnected() {\n        uni.showToast({\n          title: \"socket连接成功\",\n          duration: 2000\n        });\n      },\n\n      onClosed() {\n        uni.showToast({\n          title: \"网络已断开\",\n          icon: 'none',\n          duration: 2000\n        });\n        wx.redirectTo({\n          url: \"../login/login\"\n        });\n        me.globalData.conn.closed = true;\n        WebIM.conn.close();\n      },\n\n      onInviteMessage(message) {\n        me.globalData.saveGroupInvitedList.push(message);\n        disp.fire(\"em.invite.joingroup\", message); // wx.showModal({\n        // \ttitle: message.from + \" 已邀你入群 \" + message.roomid,\n        // \tsuccess(){\n        // \t\tdisp.fire(\"em.invite.joingroup\", message);\n        // \t},\n        // \terror(){\n        // \t\tdisp.fire(\"em.invite.joingroup\", message);\n        // \t}\n        // });\n      },\n\n      onReadMessage(message) {//console.log('已读', message)\n      },\n\n      onPresence(message) {\n        //console.log(\"onPresence\", message);\n        switch (message.type) {\n          case \"unsubscribe\":\n            break;\n          // 好友邀请列表\n          case \"subscribe\":\n            if (message.status === \"[resp:true]\") {} else {\n              // pages[0].handleFriendMsg(message);\n              for (let i = 0; i < me.globalData.saveFriendList.length; i++) {\n                if (me.globalData.saveFriendList[i].from === message.from) {\n                  me.globalData.saveFriendList[i] = message;\n                  disp.fire(\"em.subscribe\");\n                  return;\n                }\n              }\n\n              me.globalData.saveFriendList.push(message);\n              disp.fire(\"em.subscribe\");\n            }\n\n            break;\n\n          case \"subscribed\":\n            uni.showToast({\n              title: \"添加成功\",\n              duration: 1000\n            });\n            disp.fire(\"em.subscribed\");\n            break;\n\n          case \"unsubscribed\":\n            // uni.showToast({\n            // \ttitle: \"已拒绝\",\n            // \tduration: 1000\n            // });\n            break;\n\n          case \"memberJoinPublicGroupSuccess\":\n            uni.showToast({\n              title: \"已进群\",\n              duration: 1000\n            });\n            break;\n\n          case \"unavailable\":\n            disp.fire(\"em.contacts.remove\");\n            disp.fire(\"em.group.leaveGroup\", message);\n            break;\n\n          case 'deleteGroupChat':\n            disp.fire(\"em.invite.deleteGroup\", message);\n            break;\n\n          case \"leaveGroup\":\n            disp.fire(\"em.group.leaveGroup\", message);\n            break;\n\n          case \"removedFromGroup\":\n            disp.fire(\"em.group.leaveGroup\", message);\n            break;\n\n          default:\n            break;\n        }\n      },\n\n      onRoster(message) {// let pages = getCurrentPages();\n        // if(pages[0]){\n        // \tpages[0].onShow();\n        // }\n      },\n\n      onVideoMessage(message) {\n        console.log(\"onVideoMessage: \", message);\n\n        if (message) {\n          msgStorage.saveReceiveMsg(message, msgType.VIDEO);\n        }\n\n        calcUnReadSpot(message);\n        ack(message);\n      },\n\n      onAudioMessage(message) {\n        console.log(\"onAudioMessage\", message);\n\n        if (message) {\n          if (onMessageError(message)) {\n            msgStorage.saveReceiveMsg(message, msgType.AUDIO);\n          }\n\n          calcUnReadSpot(message);\n          ack(message);\n        }\n      },\n\n      onCmdMessage(message) {\n        console.log(\"onCmdMessage\", message);\n\n        if (message) {\n          if (onMessageError(message)) {\n            msgStorage.saveReceiveMsg(message, msgType.CMD);\n          }\n\n          calcUnReadSpot(message);\n          ack(message);\n        }\n      },\n\n      // onLocationMessage(message){\n      // \tconsole.log(\"Location message: \", message);\n      // \tif(message){\n      // \t\tmsgStorage.saveReceiveMsg(message, msgType.LOCATION);\n      // \t}\n      // },\n      onTextMessage(message) {\n        console.log(\"onTextMessage\", message);\n\n        if (message) {\n          if (onMessageError(message)) {\n            msgStorage.saveReceiveMsg(message, msgType.TEXT);\n          }\n\n          calcUnReadSpot(message);\n          ack(message);\n        }\n      },\n\n      onEmojiMessage(message) {\n        console.log(\"onEmojiMessage\", message);\n\n        if (message) {\n          if (onMessageError(message)) {\n            msgStorage.saveReceiveMsg(message, msgType.EMOJI);\n          }\n\n          calcUnReadSpot(message);\n          ack(message);\n        }\n      },\n\n      onPictureMessage(message) {\n        console.log(\"onPictureMessage\", message);\n\n        if (message) {\n          if (onMessageError(message)) {\n            msgStorage.saveReceiveMsg(message, msgType.IMAGE);\n          }\n\n          calcUnReadSpot(message);\n          ack(message);\n        }\n      },\n\n      onFileMessage(message) {\n        console.log('onFileMessage', message);\n\n        if (message) {\n          if (onMessageError(message)) {\n            msgStorage.saveReceiveMsg(message, msgType.FILE);\n          }\n\n          calcUnReadSpot(message);\n          ack(message);\n        }\n      },\n\n      // 各种异常\n      onError(error) {\n        console.log(error); // 16: server-side close the websocket connection\n\n        if (error.type == WebIM.statusCode.WEBIM_CONNCTION_DISCONNECTED) {\n          // if(error.type == WebIM.statusCode.WEBIM_CONNCTION_DISCONNECTED && !logout){\n          // if(WebIM.conn.autoReconnectNumTotal < WebIM.conn.autoReconnectNumMax){\n          // \treturn;\n          // }\n          uni.showToast({\n            title: \"server-side close the websocket connection\",\n            duration: 1000\n          });\n          wx.redirectTo({\n            url: \"../login/login\"\n          });\n          logout = true;\n          return;\n        } // 8: offline by multi login\n\n\n        if (error.type == WebIM.statusCode.WEBIM_CONNCTION_SERVER_ERROR) {\n          uni.showToast({\n            title: \"offline by multi login\",\n            duration: 1000\n          });\n          wx.redirectTo({\n            url: \"../login/login\"\n          });\n        }\n\n        if (error.type == WebIM.statusCode.WEBIM_CONNCTION_OPEN_ERROR) {\n          wx.hideLoading();\n          disp.fire(\"em.error.passwordErr\"); // wx.showModal({\n          // \ttitle: \"用户名或密码错误\",\n          // \tconfirmText: \"OK\",\n          // \tshowCancel: false\n          // });\n        }\n\n        if (error.type == WebIM.statusCode.WEBIM_CONNCTION_AUTH_ERROR) {\n          wx.hideLoading();\n          disp.fire(\"em.error.tokenErr\");\n        }\n\n        if (error.type == 'socket_error') {\n          ///sendMsgError\n          console.log('socket_errorsocket_error', error);\n          uni.showToast({\n            title: \"网络已断开\",\n            icon: 'none',\n            duration: 2000\n          });\n          disp.fire(\"em.error.sendMsgErr\", error);\n        }\n      }\n\n    });\n    this.globalData.checkIsIPhoneX();\n  },\n\n  methods: {}\n};\n","import mod from \"-!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./App.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./App.vue?vue&type=style&index=0&lang=css&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1589427989556\n      var cssReload = require(\"/Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  ","var render, staticRenderFns, recyclableRender, components\nvar renderjs\nimport script from \"./App.vue?vue&type=script&lang=js&\"\nexport * from \"./App.vue?vue&type=script&lang=js&\"\nimport style0 from \"./App.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"Users/lr/Documents/work/easemob-uniapp/webim-uniapp-demo/App.vue\"\nexport default component.exports"],"sourceRoot":""}