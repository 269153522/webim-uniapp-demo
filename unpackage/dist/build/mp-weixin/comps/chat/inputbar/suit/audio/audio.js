(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["comps/chat/inputbar/suit/audio/audio"],{"288c":function(e,t,o){"use strict";var n=o("f59c"),a=o.n(n);a.a},"67e8":function(e,t,o){"use strict";o.r(t);var n=o("ed52"),a=o("e8be");for(var c in a)"default"!==c&&function(e){o.d(t,e,(function(){return a[e]}))}(c);o("288c");var r,s=o("f0c5"),i=Object(s["a"])(a["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],r);t["default"]=i.exports},7349:function(e,t,o){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=o("d98b")["default"],a=o("637f"),c=o("cace"),r=c.RecordStatus,s=c.RecordDesc,i=o("0fac"),u=o("a563"),d=!1,f=[50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50],h={data:function(){return{changedTouches:null,recordStatus:r.HIDE,RecordStatus:r,RecordDesc:s,radomheight:f,recorderManager:wx.getRecorderManager(),recordClicked:!1,isLongPress:!1}},components:{},props:{username:{type:Object,default:function(){return{}}},chatType:{type:String,default:a.chatType.SINGLE_CHAT}},created:function(){},beforeMount:function(){},moved:function(){},destroyed:function(){},mounted:function(){},methods:{toggleWithoutAction:function(e){},toggleRecordModal:function(){this.setData({recordStatus:this.recordStatus==r.HIDE?r.SHOW:r.HIDE,radomheight:f})},handleRecordingMove:function(e){var t=e.touches[0],o=this.changedTouches;o&&(this.recordStatus==r.SWIPE&&o.pageY-t.pageY<20&&this.setData({recordStatus:r.HOLD}),this.recordStatus==r.HOLD&&o.pageY-t.pageY>20&&this.setData({recordStatus:r.SWIPE}))},handleRecording:function(t){var o=this;function n(){wx.getSetting({success:function(t){var n=t.authSetting["scope.record"];0==n?wx.openSetting({success:function(t){var n=t.authSetting["scope.record"];1==n?e.showToast({title:"授权成功",icon:"success"}):e.showToast({title:"请授权录音",icon:"none"}),o.setData({isLongPress:!1})}}):1==n?a():wx.authorize({scope:"scope.record",success:function(){e.showToast({title:"授权成功",icon:"success"})}})},fail:function(){e.showToast({title:"鉴权失败，请重试",icon:"none"})}})}function a(){o.changedTouches=t.touches[0],o.setData({recordStatus:r.HOLD}),d=!0,o.myradom();var e=o.recorderManager||wx.getRecorderManager();e.onStart((function(){})),e.start({format:"mp3"}),setTimeout((function(){o.handleRecordingCancel(),d=!1}),1e5)}o.setData({recordClicked:!0}),setTimeout((function(){1==o.recordClicked&&n()}),350)},handleRecordingCancel:function(){var t=this;d=!1;var o=this.recorderManager;this.recordStatus==r.SWIPE?this.setData({recordStatus:r.RELEASE}):this.setData({recordStatus:r.HIDE,recordClicked:!1}),o.onStop((function(o){if(t.recordStatus==r.RELEASE)return console.log("user canceled"),void t.setData({recordStatus:r.HIDE});o.duration<1e3?e.showToast({title:"录音时间太短",icon:"none"}):t.uploadRecord(o.tempFilePath,o.duration)})),o.stop()},isGroupChat:function(){return this.chatType==a.chatType.CHAT_ROOM},getSendToParam:function(){return this.isGroupChat()?this.username.groupId:this.username.your},uploadRecord:function(e,t){var o=n.config.appkey.split("#"),c=this,r=n.conn.context.accessToken;wx.uploadFile({url:"https://a1.easemob.com/"+o[0]+"/"+o[1]+"/chatfiles",filePath:e,name:"file",header:{"Content-Type":"multipart/form-data",Authorization:"Bearer "+r},success:function(o){var s=n.conn.getUniqueId(),u=new n.message(a.AUDIO,s),d=JSON.parse(o.data);u.set({apiUrl:n.config.apiURL,accessToken:r,body:{type:a.AUDIO,url:d.uri+"/"+d.entities[0].uuid,filetype:"",filename:e,accessToken:r,length:Math.ceil(t/1e3)},from:c.username.myName,to:c.getSendToParam(),roomType:!1,chatType:c.chatType,success:function(e){i.fire("em.chat.sendSuccess",s)}}),c.isGroupChat()&&u.setGroup("groupchat"),u.body.length=Math.ceil(t/1e3),n.conn.send(u.body);var f={msg:u,type:a.AUDIO};c.saveSendMsg(f)}})},saveSendMsg:function(e){u.saveMsg(e.msg,e.type)},myradom:function(){for(var e=this,t=e.radomheight,o=0;o<e.radomheight.length;o++)t[o]=100*Math.random().toFixed(2)+10;e.setData({radomheight:t}),d&&setTimeout((function(){e.myradom()}),500)}}};t.default=h}).call(this,o("543d")["default"])},e8be:function(e,t,o){"use strict";o.r(t);var n=o("7349"),a=o.n(n);for(var c in n)"default"!==c&&function(e){o.d(t,e,(function(){return n[e]}))}(c);t["default"]=a.a},ed52:function(e,t,o){"use strict";var n,a=function(){var e=this,t=e.$createElement;e._self._c},c=[];o.d(t,"b",(function(){return a})),o.d(t,"c",(function(){return c})),o.d(t,"a",(function(){return n}))},f59c:function(e,t,o){}}]);
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'comps/chat/inputbar/suit/audio/audio-create-component',
    {
        'comps/chat/inputbar/suit/audio/audio-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('543d')['createComponent'](__webpack_require__("67e8"))
        })
    },
    [['comps/chat/inputbar/suit/audio/audio-create-component']]
]);
